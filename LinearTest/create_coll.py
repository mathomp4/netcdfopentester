#!/usr/bin/env python

import argparse

from netCDF4 import Dataset

def main():

    args = parse_args()
    numvars = args['numvars']

    filename = "test_"+str(numvars)+"vars.nc4"

    rootgrp = Dataset(filename, "w", format="NETCDF4")

    lon   = rootgrp.createDimension("lon", 144)
    lat   = rootgrp.createDimension("lat", 91)
    level = rootgrp.createDimension("level", 72)
    time  = rootgrp.createDimension("time", 1)

    latitudes  = rootgrp.createVariable("lat","f4",("lat",))
    longitudes = rootgrp.createVariable("lon","f4",("lon",))
    times      = rootgrp.createVariable("time","f4",("time",))
    levels     = rootgrp.createVariable("level","i4",("level",))


    basestring = "var"

    for x in range(1, numvars+1):
        newvar = basestring+str(x).zfill(4)
        temp = rootgrp.createVariable(newvar,"f4",("time","level","lat","lon",),zlib=True)
        temp[:,:,:,:] = x


    rootgrp.close()


def parse_args():

    p = argparse.ArgumentParser(description='Quick nc4 generator')

    p.add_argument('-n', '--numvars', type=int, help='Number of variables to create', required=True)

    return vars(p.parse_args())

if __name__=="__main__":
    main()
